# macOS IAC DRIVER SETUP GUIDE
# Configuration for Traktor Pro 3 AI DJ Agent System
# Inter-Application Communication Driver Setup
# Version: 1.0
# Created: 2025-09-27

## OVERVIEW
The IAC (Inter-Application Communication) Driver is a built-in macOS feature that creates virtual MIDI buses for communication between applications. This guide configures IAC for bidirectional MIDI communication between your AI DJ agent and Traktor Pro 3.

## SYSTEM REQUIREMENTS
- macOS 10.14 (Mojave) or later
- Traktor Pro 3 (version 3.0 or later)
- Admin privileges for driver configuration
- Audio MIDI Setup utility (included with macOS)

## STEP-BY-STEP CONFIGURATION

### STEP 1: Open Audio MIDI Setup
1. Press `Cmd + Space` to open Spotlight search
2. Type "Audio MIDI Setup" and press Enter
3. Alternatively: Go to Applications > Utilities > Audio MIDI Setup

### STEP 2: Access MIDI Studio
1. In Audio MIDI Setup, click "Window" in the menu bar
2. Select "Show MIDI Studio" (or press `Cmd + 2`)
3. The MIDI Studio window will open showing MIDI devices

### STEP 3: Configure IAC Driver
1. Look for the "IAC Driver" icon in the MIDI Studio window
   - If not visible, it may be minimized or hidden
   - Check under "MIDI devices" section
2. Double-click the "IAC Driver" icon to open its properties
3. In the IAC Driver Properties window:
   - Check the box "Device is online" to enable the driver
   - This activates the virtual MIDI ports

### STEP 4: Configure MIDI Buses
1. In the IAC Driver Properties window, you'll see the "Ports" section
2. By default, there should be one port named "Bus 1"
3. For AI DJ Agent system, configure as follows:
   - Bus 1: AI DJ Control (primary communication)
   - Optionally add Bus 2: Backup/Secondary channel

To add additional buses:
1. Click the "+" button below the ports list
2. Rename buses by double-clicking on their names
3. Recommended names:
   - Bus 1: "AI DJ Control"
   - Bus 2: "AI DJ Backup" (optional)

### STEP 5: Verify IAC Driver Status
1. Ensure "Device is online" is checked
2. Verify Bus 1 is listed and active
3. Note the exact name of Bus 1 for Traktor configuration
4. Click "Apply" to save changes
5. Close the IAC Driver Properties window

### STEP 6: Test IAC Driver Functionality
1. Keep Audio MIDI Setup open
2. In the MIDI Studio, you should see cables connecting to IAC Driver
3. The driver icon should appear solid (not grayed out)
4. Test with a simple MIDI application if needed

## TRAKTOR PRO 3 MIDI SETUP

### STEP 7: Configure Traktor MIDI Preferences
1. Open Traktor Pro 3
2. Go to Preferences (Traktor > Preferences or Cmd + ,)
3. Navigate to "Controller Manager" in the left sidebar

### STEP 8: Add Generic MIDI Device
1. In Controller Manager, click "Add..." button
2. Select "Generic MIDI" from the device list
3. Choose a device name: "AI DJ Agent Controller"
4. Click "OK" to create the device

### STEP 9: Configure MIDI Ports
1. Select the newly created "AI DJ Agent Controller"
2. In the device settings:

**Input Configuration:**
- In-Port: Select "Bus 1" (or your renamed IAC bus)
- This allows Traktor to receive MIDI from AI agent

**Output Configuration:**
- Out-Port: Select "Bus 1" (same as input)
- This allows Traktor to send status back to AI agent

**MIDI Channel Settings:**
- Leave as "All" or configure specific channels (1-4)
- The mapping file specifies which channels to use

### STEP 10: Import Mapping Configuration
1. In Controller Manager, with "AI DJ Agent Controller" selected
2. Click "Settings" menu, then "Import"
3. Navigate to the AI DJ Agent mapping file
4. Select the mapping specification file
5. Import all control assignments

## SECURITY AND PERMISSIONS

### macOS Security Settings
1. System Preferences > Security & Privacy
2. Go to "Privacy" tab
3. Select "Microphone" in the left sidebar
4. Ensure Traktor Pro 3 has microphone access if needed
5. Select "Accessibility" for advanced MIDI control

### MIDI Permissions
1. Some AI applications may require MIDI permissions
2. Grant access when prompted by macOS
3. Check System Preferences > Security & Privacy > Privacy > Automation
4. Allow your AI application to control Traktor and Audio MIDI Setup

## ADVANCED CONFIGURATION

### Multiple MIDI Buses
For complex setups, configure additional buses:

1. **Bus 1: AI Control Input**
   - Primary commands from AI to Traktor
   - Channels 1, 3, 4 (Control, Override, Effects)

2. **Bus 2: Status Output**
   - Real-time feedback from Traktor to AI
   - Channel 2 (Status Feedback)

### Buffer Size Optimization
1. In Traktor Preferences > Audio Setup
2. Set Buffer Size to 128 samples or lower
3. This reduces MIDI latency for real-time control
4. Monitor CPU usage to prevent dropouts

### Sample Rate Configuration
1. Recommended: 44.1 kHz or 48 kHz
2. Higher rates may increase CPU load
3. Ensure consistent rate across all audio devices

## TROUBLESHOOTING

### Common Issues and Solutions

**IAC Driver Not Visible:**
- Restart Audio MIDI Setup
- Check macOS version compatibility
- Verify admin privileges

**"Device is online" Grayed Out:**
- Close all applications using MIDI
- Reset MIDI configuration in Audio MIDI Setup
- Restart macOS if necessary

**Traktor Not Receiving MIDI:**
- Verify IAC Driver is online and Bus 1 is active
- Check Traktor Input port selection
- Test with MIDI monitor application
- Restart Traktor Pro 3

**High MIDI Latency:**
- Reduce audio buffer size in Traktor
- Close unnecessary applications
- Check Activity Monitor for CPU usage
- Update macOS and Traktor to latest versions

**Connection Drops:**
- Disable energy saving for USB devices
- Check for conflicting MIDI applications
- Restart IAC Driver (uncheck/check "Device is online")

### MIDI Testing Tools
1. **MIDI Monitor** (free app): Test MIDI communication
2. **SysEx Librarian**: Advanced MIDI diagnostics
3. **MidiPipe**: MIDI routing and filtering
4. Built-in Audio MIDI Setup test features

## PERFORMANCE OPTIMIZATION

### System Settings for Low Latency
1. **Energy Saver Settings:**
   - Set to "High Performance" when plugged in
   - Disable "Put hard disks to sleep"

2. **Activity Monitor:**
   - Close unnecessary background applications
   - Monitor CPU usage during DJ sessions

3. **Network Settings:**
   - Disable automatic software updates during sessions
   - Turn off cloud sync for DJ applications

### MIDI Timing Optimization
1. **Clock Source:**
   - Use internal clock in Traktor
   - Avoid external MIDI clock sync unless required

2. **Processing Priority:**
   - Set Traktor process priority to "High"
   - Use real-time audio drivers when available

## BACKUP AND RECOVERY

### Save Configuration
1. Export Traktor mapping: Controller Manager > Export
2. Save IAC Driver settings: Audio MIDI Setup > File > Export Configuration
3. Document custom bus names and settings

### Recovery Procedures
1. **Reset IAC Driver:**
   - Uncheck "Device is online"
   - Wait 10 seconds
   - Check "Device is online" again

2. **Reset MIDI Configuration:**
   - Audio MIDI Setup > Window > Reset MIDI
   - Reconfigure IAC Driver as above

3. **Traktor MIDI Reset:**
   - Delete controller in Controller Manager
   - Re-add and import mapping

## INTEGRATION WITH AI APPLICATIONS

### Python MIDI Libraries
```python
# Example for Python-based AI agents
import mido
import time

# List available MIDI ports
print("Available MIDI ports:")
print("Input ports:", mido.get_input_names())
print("Output ports:", mido.get_output_names())

# Connect to IAC Driver Bus 1
outport = mido.open_output('Bus 1')
inport = mido.open_input('Bus 1')

# Send MIDI CC message (example: Master Volume)
msg = mido.Message('control_change', channel=0, control=7, value=64)
outport.send(msg)
```

### Node.js MIDI Integration
```javascript
// Example for Node.js-based AI agents
const midi = require('midi');

// Set up output port
const output = new midi.Output();
output.openPort(0); // Bus 1

// Send MIDI CC message
output.sendMessage([176, 7, 64]); // Channel 1, CC 7, Value 64
```

## MONITORING AND DIAGNOSTICS

### Real-time MIDI Monitoring
1. Use MIDI Monitor app to view all MIDI traffic
2. Filter by channel to isolate AI communication
3. Log MIDI events for debugging
4. Monitor timing accuracy and latency

### Performance Metrics
1. **MIDI Latency:** Target < 10ms
2. **Update Rate:** 40Hz for status feedback
3. **CPU Usage:** Keep below 80% during operation
4. **Memory Usage:** Monitor for memory leaks

## CONCLUSION
This configuration creates a robust, low-latency MIDI communication channel between your AI DJ agent and Traktor Pro 3. The IAC Driver provides reliable virtual MIDI routing while maintaining system stability and professional performance standards.

For additional support:
- Check Traktor Pro 3 documentation
- Visit Native Instruments community forums
- Consult macOS Audio MIDI Setup help

## VERSION NOTES
- Compatible with macOS 10.14+
- Tested with Traktor Pro 3.5+
- Optimized for real-time AI control
- Supports both local and networked AI agents

## END OF SETUP GUIDE